<div flex layout="column" id="oper" ng-class="{true: 'end-state'}[setting.readonly]">
    <form name="patInfo" role="form" novalidate class="panel panel-default">
        <div class="panel-heading">病人基本信息</div>
        <div class="wrap" layout layout-wrap="wrap">
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>姓名</label>
                    <input flex focus type="text" name="name" class="form-control" ng-model="regOpt.name" maxlength="20" ng-blur="_name = true" required>
                </div>
                <p ng-if="!regOpt.name && (_name || verify == false)" class="help-block text-right">姓名不能为空</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>性别</label>
                    <select flex name="sex" class="form-control"  ng-options="item for item in sexList" ng-model="regOpt.sex" ng-blur="_sex = true" required></select>
                </div>
                <p ng-if="!regOpt.sex && (_sex || verify == false)" class="help-block text-right">请选择性别</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>年龄(岁)</label>
                    <input flex type="number" name="age" class="form-control" ng-model="regOpt.age" min="0" max="200" ng-blur="_age = true">
                </div>
                <p ng-if="regOpt.age == undefined && regOpt.ageMon == undefined && regOpt.ageDay == undefined && _age == true" class="help-block text-right">(年/月/日)选填项，0~200</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">月</label>
                    <input flex type="number" name="ageMon" class="form-control" ng-model="regOpt.ageMon" min="0" max="11" ng-blur="_ageMon = true">
                </div>
                <p ng-if="regOpt.age == undefined && regOpt.ageMon == undefined && regOpt.ageDay == undefined && _ageMon == true" class="help-block text-right">(年/月/日)选填项，0~11</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">天</label>
                    <input flex type="number" name="ageDay" class="form-control" ng-model="regOpt.ageDay" min="0" max="364" ng-blur="_ageDay = true">
                </div>
                <p ng-if="regOpt.age == undefined && regOpt.ageMon == undefined && regOpt.ageDay == undefined && _ageDay == true" class="help-block text-right">(年/月/日)选填项，0~364</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">住院号</label>
                    <input flex type="text" name="hid" class="form-control" ng-model="regOpt.hid" maxlength="14">
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">病区</label>
                    <oi-select flex name="region" oi-options="item.regionId as item.name for item in regionList | limitTo: 100" ng-model="regOpt.regionId" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">科室</label>
                    <oi-select flex name="dept" oi-options="item.deptId as item.name for item in deptList | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="regOpt.deptId"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">床号</label>
                    <input flex type="text" name="bed" class="form-control" ng-model="regOpt.bed" maxlength="6">
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">费用类型</label>
                    <select flex name="medicalType" class="form-control"  ng-options="item for item in chargeType" ng-model="regOpt.medicalType" ><option value=""></option></select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">体重(KG)</label>
                    <input flex type="number" name="weight" class="form-control" ng-model="regOpt.weight" min="1" max="300">
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">HBsAg</label>
                    <select flex name="hbsag"  class="form-control" ng-options="item for item in templete" ng-model="regOpt.hbsag" ><option value=""></option></select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">抗HCV</label>
                    <select flex name="hcv" class="form-control" ng-options="item for item in templete" ng-model="regOpt.hcv" ><option value=""></option></select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">抗HIV</label>
                    <select flex name="hiv" class="form-control" ng-options="item for item in templete" ng-model="regOpt.hiv" ><option value=""></option></select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">抗HP</label>
                    <select flex name="hp" class="form-control" ng-options="item for item in templete" ng-model="regOpt.hp" ><option value=""></option></select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">身高(CM)</label>
                    <input flex type="number" name="height" class="form-control" ng-model="regOpt.height" min="1" max="300">
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">手术来源</label>
                    <select flex name="operSource" class="form-control" ng-options="item.type as item.name for item in operSourceList" ng-model="regOpt.operSource" ><option value=""></option></select>
                </div>
            </div>
            <div flex class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">药物过敏史</label>
                    <input flex type="text" name="hyperSusceptiBility" class="form-control" ng-model="regOpt.hyperSusceptiBility" maxlength="60">
                </div>
            </div>
        </div>
    </form>
    <form name="operInfo" role="form" novalidate class="panel panel-default">
        <div class="panel-heading">手术基本信息</div>
        <div class="wrap" layout layout-wrap="wrap">
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>手术日期</label>
                    <input datetimepicker="" flex name="operaDate" dateID="opera-date" maxdate="2100-01-01" ng-model="regOpt.operaDate" timepicker="false" format="Y-m-d" class="form-control" ng-blur="_operaDate = true" required></input>
                </div>
                <p ng-if="!regOpt.operaDate && (_operaDate || verify == false)" class="help-block text-right">手术日期不能为空</p>
            </div>
            <div flex="20" class="input-wrap" ng-if="docInfo.originRequire">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>手术类型</label>
                    <select flex class="form-control" name="origin" ng-options="item.type as item.name for item in originList" ng-model="regOpt.origin" ng-disabled="regOpt.regOptId || ((regOpt.origin == 2 || regOpt.origin == 3) && page != 'editOperDateil')" ng-blur="_origin = true"  required></select>
                </div>
                <p ng-if="!regOpt.origin && (_origin || verify == false)" class="help-block text-right">请选择手术类型</p>
            </div>
            <div flex="20" class="input-wrap" ng-if="!docInfo.originRequire">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>手术类型</label>
                    <select flex class="form-control" name="emergency" ng-options="item.type as item.name for item in emergencyList" ng-model="regOpt.emergency" ng-disabled="regOpt.regOptId || (regOpt.emergency == 1 && page != 'editOperDateil')" ng-blur="_emergency = true"  required></select>
                </div>
                <p ng-if="!regOpt.emergency && (_emergency || verify == false)" class="help-block text-right">请选择手术类型</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em ng-if="docInfo.optLevelRequire">*</em>手术等级</label>
                    <select flex class="form-control" name="optLevel" ng-options="item for item in optLevelList" ng-model="regOpt.optLevel"  ng-blur="_optLevel = true"  ng-required="docInfo.optLevelRequire ? true : false"></select>
                </div>
                <p ng-if="!regOpt.optLevel && docInfo.optLevelRequire && (_optLevel || verify == false)" class="help-block text-right">请选择手术等级</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>主刀医生</label>
                    <oi-select flex name="operator" oi-options="item.operatorId as item.name for item in getOperaList($query, regOpt.assistants) | limitTo: 100" oi-select-options="{ listFilter: 'oiSelectAscSort:[\'pinYin\']'}" ng-model="regOpt.operatorId" ng-blur="_operator = true" required>
                    </oi-select>
                </div>
                <p ng-if="!regOpt.operatorId && (_operator || verify == false)" class="help-block text-right">主刀医生不能为空</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">切口等级</label>
                    <select flex class="form-control" name="cutLevel" ng-options="item.type as item.name for item in cutLevelList" ng-model="regOpt.cutLevel" ng-blur="_cutLevel = true"><option value=""></option></select>
                </div>
            </div>
            <div flex="40" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">助手医生</label>
                    <oi-select flex multiple name="assistant" oi-options="item.operatorId as item.name for item in getOperaList($query, regOpt.operatorId) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']'}" ng-model="regOpt.assistants"></oi-select>
                </div>
            </div>
            <div flex="60" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>术前诊断</label>
                    <oi-select flex multiple class="multiline" name="basDiagnosedefs"
                        oi-options="item.name for item in getOptionList($query) | limitTo: 100" 
                        oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', editItem: true, newItem: true, newItemModel: {name: $query}}"
                        ng-model="regOpt.diagnosisCodes"
                        ng-blur="_basDiagnosedefs = true;"
                        required>
                    </oi-select>
                </div>
                <p ng-if="!regOpt.diagnosisCodes && (_basDiagnosedefs || verify == false)" class="help-block text-right">术前诊断不能为空</p>
            </div>
            <div flex="40" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>麻醉方法</label>
                    <oi-select flex multiple class="multiline" name="basAnaesMethods"
                        oi-options="item.anaMedId as item.name for item in anaesMethodList | limitTo: 100"
                        oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']'}"
                        ng-model="regOpt.designedAnaesMethodCodes" ng-blur="changeAnaesMethods(); _basAnaesMethods = true" required>
                    </oi-select>
                </div>
                <p ng-if="!regOpt.designedAnaesMethodCodes && (_basAnaesMethods || verify == false)" class="help-block text-right">麻醉方法不能为空</p>
            </div>
            <div flex="60" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em ng-if="regOpt.emergency&&docInfo.designedOptCodes">*</em>拟施手术</label>   
                    <oi-select flex multiple class="multiline" name="basOperdefs"
                        oi-options="item.name for item in getOperdefList($query) | limitTo: 100" 
                        oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', editItem: true, newItem: true, newItemModel: {name: $query}}"
                        ng-blur="_basOperdefs = true"
                        ng-model="regOpt.designedOptCodes">
                    </oi-select>
                     
                </div>
                <p ng-if="regOpt.emergency&&docInfo.designedOptCodes&&!regOpt.designedOptCodes && (_basOperdefs || verify == false)" class="help-block text-right">拟施手术不能为空</p>
            </div>
            <div flex="100" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">备注</label>
                    <input flex type="text" name="remark" class="form-control" ng-model="regOpt.remark" maxlength="110">
                </div>
            </div>
        </div>
    </form>
    <form name="schedule" role="form" novalidate class="panel panel-default" ng-show="regOpt.emergency == 1 || (regOpt.state && regOpt.state != '01' && regOpt.state != '02')" >
        <div class="panel-heading">手术排程信息</div>
        <div class="wrap" layout layout-wrap="wrap">
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>手术室</label>
                    <select class="form-control" flex name="operRoomId" ng-options="item.operRoomId as item.name for item in operRoomList" ng-model="dispatch.operRoomId" ng-blur="_operRoomId = true" required></select>
                </div>
                <p ng-if="!dispatch.operRoomId && (_operRoomId || verify == false)" class="help-block text-right">请选择手术室</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em ng-if="false">*</em>手术时间</label>
                    <input datetimepicker="" flex name="startTime" dateID="start-time" ng-model="dispatch.startTime" datepicker="false" timepicker="true" format="H:i" class="form-control"  ng-required="false"></input>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em ng-if=" regOpt.emergency == 1">*</em>手术台次</label>
                    <select class="form-control" flex name="pcs" ng-options="item.codeValue as item.codeName for item in pacList" ng-model="dispatch.pcs" ng-blur="_pcs = true" ng-required="regOpt.emergency == 1 ? true : false"></select>
                </div>
                <p ng-if="(!dispatch.pcs && regOpt.emergency == 1) && (_pcs || verify == false)" class="help-block text-right">请选择手术台次</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em ng-if="regOpt.isLocalAnaes != 1">*</em>麻醉医生</label>
                    <oi-select flex name="anesthetist" oi-options="item.userName as item.name for item in getAnesList($query, dispatch.perfusionDoctorId) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.anesthetistId" ng-blur="_anesthetist = true" ng-required="regOpt.isLocalAnaes != 1"></oi-select>
                </div>
                <p ng-if="_anesthetist && dispatch.anesthetistId == undefined && regOpt.isLocalAnaes != 1" class="help-block text-right">麻醉医生不能为空</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">副麻医生</label>
                    <oi-select flex name="circuAnesthetist" oi-options="item.userName as item.name for item in getAnesList($query, dispatch.anesthetistId) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.circuAnesthetistId"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit"><em>*</em>第一巡回护士</label>
                    <oi-select flex name="circunurse1" oi-options="item.userName as item.name for item in getNurseList($query, dispatch.circunurseId2, dispatch.healthNurse, dispatch.instrnurseId1, dispatch.instrnurseId2) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.circunurseId1" ng-blur="_circunurse1 = true" required></oi-select>
                </div>
                <p ng-if="!dispatch.circunurseId1 && (_circunurse1 || verify == false)" class="help-block text-right">第一巡回护士不能为空</p>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">第二巡回护士</label>
                    <oi-select flex name="circunurse2" oi-options="item.userName as item.name for item in getNurseList($query, dispatch.circunurseId1, dispatch.healthNurse, dispatch.instrnurseId1, dispatch.instrnurseId2) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.circunurseId2"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">卫生护士</label>
                    <oi-select flex name="healthNurse" oi-options="item.userName as item.name for item in getNurseList($query, dispatch.circunurseId1, dispatch.circunurseId2, dispatch.instrnurseId1, dispatch.instrnurseId2) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.healthNurse"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">第一洗手护士</label>
                    <oi-select flex name="instrnurse1" oi-options="item.userName as item.name for item in getNurseList($query, dispatch.circunurseId1, dispatch.circunurseId2, dispatch.healthNurse, dispatch.instrnurseId2) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.instrnurseId1"></oi-select>
                </div>
            </div>
            <div flex="20" class="input-wrap">
                <div layout layout-align="start center" class="input-group">
                    <label class="tit">第二洗手护士</label>
                    <oi-select flex name="instrnurse2" oi-options="item.userName as item.name for item in getNurseList($query, dispatch.circunurseId1, dispatch.circunurseId2, dispatch.healthNurse, dispatch.instrnurseId1) | limitTo: 100" oi-select-options="{listFilter: 'oiSelectAscSort:[\'pinYin\']', cleanModel: true}" ng-model="dispatch.instrnurseId2"></oi-select>
                </div>
            </div>
        </div>
    </form>
</div>
